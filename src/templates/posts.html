{% extends "layout.html" %}
{% block title %}{{forum.name}}{% endblock %}
{% block content %}
    <h2>{{forum.name}}</h2>
    <p>{{forum.description}}</p>
    {% if session.username %}
        <h3>Create a new post</h3>
        <form action="/forums/{{forum.id}}/posts" method="POST">
            <label for="title">Title</label>
            <input type="text" name="title" id="title">
            <label for="body">Body</label>
            <input type="text" name="body" id="body">
            <input type="submit" value="Create">
            <input type="hidden" name="csrf_token" value="{{ session.csrf_token }}">
        </form>
    {% endif %}
    {% for post in posts %}
        <div>
            <h3>{{ post.title }}</h3>
            <p>{{ post.body }}</p>
            <a href="/forums/{{forum.id}}/posts/{{ post.id }}/comments">{{ post.comment_count }} comments</a>
            <p> {{ post.author }} </p>
            <p>
                {{ post.like_count }} likes
                {% if session.user_id %}
                    {% if post.liked_by_curr_user %}
                        <form action="/forums/{{forum.id}}/posts/{{post.id}}/unlike" method="POST">
                            <input type="submit"  value="Unlike">
                            <input type="hidden" name="csrf_token" value="{{ session.csrf_token }}">
                        </form>
                    {% else %}
                        <form action="/forums/{{forum.id}}/posts/{{post.id}}/like" method="POST">
                            <input type="submit"  value="Like">
                            <input type="hidden" name="csrf_token" value="{{ session.csrf_token }}">
                        </form>
                    {% endif %}
                {% endif %}
            </p>
        </div>
    {% endfor %}
{% endblock %}